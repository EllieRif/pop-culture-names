---
title: "names and pop culture"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown



```{r}
library(tidyverse)
```
```{r}
library(babynames)

```





```{r}
babynames %>%
  #filter(name %in% c("Madison", "Hermione", "Chandler", "Cady", "Barack", "Diana", "Heather", "Elle", "Ariel")) %>%
  filter(name %in% c("Cher", "Dionne"), sex=="F") %>%
  filter(year>=1960) %>%
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = name)) + 
  facet_grid((name~.), scales = "free_y") + 
  geom_vline(aes(xintercept = 1995), linetype = "dashed", color = "red")
```





```{r}
princess_names <- c("Ariel", "Belle", "Jasmine", "Mulan", "Tiana", "Merida", "Elsa", "Giselle")



princess_yrs <- data.frame(
  name = princess_names, 
  
  year = c(1989, 1991, 1992, 1998, 2009, 2012, 2013, 2007)
  
  
)


babynames %>%
  filter(name %in% princess_names, sex == "F") %>%
  filter(year>=1980) %>%
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = name)) + 
  facet_wrap(~name, scales = "free_y") + 
  geom_vline(aes(xintercept = year),
             linetype="dashed",
             color = "red",
             data = princess_yrs)
  
```
```{r}
prince_names <- c("Eric", "Adam", "Aladdin", "Shang", "Naveen", "Kristoff", "Flynn") 

prince_yrs <- data.frame(
  name = prince_names, 
  
  year = c(1989, 1991, 1992, 1998, 2009, 2013, 2010)
  
  
)

babynames %>%
  filter(name %in% prince_names, sex == "M") %>%
  filter(year>=1980) %>%
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = name)) + 
  facet_wrap(~name, scales = "free_y") + 
  geom_vline(aes(xintercept = year),
             linetype="dashed",
             color = "red",
             data = prince_yrs)
```




```{r}

#year markers, introduction for Harry, ron, hermione, luna, minerva, and bellatrix. increasd involvement for ginny and neville, when he became good for severus


hp_names <- c("Harry", "Ron", "Hermione", "Neville", "Ginny", "Luna", "Minerva", "Bellatrix", "Severus", "Sirius", "Draco")

book_dates <- data.frame(
  name=hp_names, year = c(1997, 1997, 1997, 1997, 2003, 2003, 1997, 2003, 2007, 1999, 1997)
)

movie_dates <- data.frame(
  name=hp_names, year = c(2001, 2001, 2001, 2001, 2007, 2007, 2001, 2007, 2011, 2004, 2001)
)

babynames %>%
  #filter(name %in% c("Madison", "Hermione", "Chandler", "Cady", "Barack", "Diana", "Heather", "Elle", "Ariel")) %>%
  filter(name %in% hp_names) %>%
  filter(year>=1990) %>%
  ggplot() +
  geom_point(mapping = aes( x = year, y = n, color = name)) + 
   geom_vline(aes(xintercept = year),
             linetype="dashed",
             color = "red",
             data = book_dates) +
   geom_vline(aes(xintercept = year),
             linetype="dashed",
             color = "navy",
             data = movie_dates) +
  facet_wrap(~name, scales = "free_y")
  

  

```


 

```{r}


babynames %>%
  #filter(name %in% c("Madison", "Hermione", "Chandler", "Cady", "Barack", "Diana", "Heather", "Elle", "Ariel")) %>%
  filter(name %in% c("Edward", "Esme", "Carlisle", "Emmett", "Alice", "Rosalie", "Jasper", "Bella")) %>%
  filter(year>=2000) %>%
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = sex)) + 
   
  geom_vline(aes(xintercept = 2005),
             linetype = "dashed",
             color = "red", ) +
    geom_vline(aes(xintercept = 2008),
             linetype = "dashed",
             color = "navy",
             ) +
  #geom_text(x=2005, y = -Inf, label = "Book", size = 4, vjust = "bottom", hjust = "right") +
  
  #annotate("text", xmin = 2007, x = 2009, y = -Inf, label = "Movie", size = 4) +
  #annotate("text", x = 2004, xmax = 2006, y = -Inf, label = "Book", size = 4) +
  coord_cartesian (clip = "off") + 
  theme(panel.spacing = unit(1, "lines")) + 
  geom_text(x=2005, y = -Inf, label = "Book", size = 4, y_nudge = -5) +
  facet_wrap(~name, scales = "free_y")

```
```{r}
babynames %>%
  #filter(name %in% c("Madison", "Hermione", "Chandler", "Cady", "Barack", "Diana", "Heather", "Elle", "Ariel")) %>%
  filter(name %in% c("Christian", "Anastasia")) %>%
  filter(year>=2000) %>%
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = name)) + 
  facet_wrap(~name, scales = "free_y") + 
  geom_vline(aes(xintercept = 2011),
             linetype = "dashed",
             color = "red") + 
    geom_vline(aes(xintercept = 2015),
             linetype = "dashed",
             color = "navy")
```



```{r}

babynames %>%
  #filter(name %in% c("Madison", "Hermione", "Chandler", "Cady", "Barack", "Diana", "Heather", "Elle", "Ariel")) %>%
  filter(name == "Madison") %>%
  #filter(year>=1960) %>%
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = sex)) + 
  facet_wrap(~sex, scales = "free_y")

mad_pre_splash <- babynames %>% 
  filter(name == "Madison", sex == "F", year < 1984) %>% 
  summarise(use = sum(n), avg = mean(n))

mad_pre_splash

mad_splash_to_90 <- babynames %>% 
  filter(name == "Madison", sex == "F", year >= 1984, year <1990) %>%
  group_by(year) %>% 
  summarise(use = sum(n))

mad_splash_to_90

mad_to_90_total <- 
  mad_splash_to_90 %>% 
  summarise(total = sum(use))

mad_to_90_total

mad_splash_to_present <- babynames %>% 
  filter(name == "Madison", sex == "F", year >= 1984)
  #group_by(year) 
  #summarise(use = sum(n))

mad_splash_to_present

avg_boys_mad_up_to_splash <- babynames %>% 
  filter(name == "Madison", sex=="M", year <1984) %>%
  summarise(avg = mean(n))

avg_boys_mad_postsplash <- babynames %>% 
  filter(name == "Madison", sex=="M", year >=1984) %>%
  summarise(avg = mean(n))
  
  
```


```{r}

#According to https://ohbabynames.com/all-baby-names/xander/, "Xander did not appear on the U.S. popularity charts as an independently given name until 1999"
babynames %>%
  #filter(name %in% c("Madison", "Hermione", "Chandler", "Cady", "Barack", "Diana", "Heather", "Elle", "Ariel")) %>%
  filter(name %in% c("Buffy", "Willow", "Xander", "Angel", "Drusilla")) %>%
  filter(year>=1960) %>%
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = sex)) + 
  facet_wrap(~name, scales = "free_y") + 
  geom_vline(aes(xintercept = 1997),
             linetype = "dashed",
             color = "red") +
  geom_vline(aes(xintercept = 2003),
             linetype = "dashed",
             color = "navy")
babynames %>% 
  filter(name=="Buffy")
  
```




```{r}

names <- c("Chandler", "Monica", "Ross", "Rachel", "Phoebe", "Joey", "Monica")
important_dates <- data.frame(
  name=names,
  year=c(1994, 1994, 1994, 1994, 1994, 1994, 1998)
)
babynames %>%
  #filter(name %in% c("Madison", "Hermione", "Chandler", "Cady", "Barack", "Diana", "Heather", "Elle", "Ariel")) %>%
  filter(name %in% names) %>%
  filter(year>=1980) %>%
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = sex)) + 
  facet_wrap(~name, scales = "free_y") +
  geom_vline(aes(xintercept = year),
             linetype="dashed",
             color = "red",
             data = important_dates) 

#To make sure the right line is assigned to the right facet, make sure the vector for the line and for the plot are both "name", and then the faceting will apply to both , same for year
```


```{r}
names <-c("Chandler", "Monica", "Ross", "Rachel", "Phoebe", "Joey")
important_dates <- data.frame(
  name="Monica",
  year=1998
)

babynames %>% 
  filter(sex == "F", name == "Monica", year >1992, year < 2000)
babynames %>%
  filter(name %in% names) %>%
  filter(year>=1980) %>%
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = sex)) + 
  geom_vline(aes(xintercept = 1994),
             linetype = "dashed",
             color = "red") +
  facet_wrap(~name, scales = "free_y") + 
  geom_vline(aes(xintercept=year), linetype = "dashed", color = "navy", data = important_dates)

```


```{r}
babynames %>%
  filter(name %in% c("Kim", "Khloe", "Kris", "Kylie", "Kendall", "Kourtney")) %>%
  filter(year>=1980, sex == "F") %>% 
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = name)) + 
  facet_wrap(~name, scales = "free_y") +  geom_vline(aes(xintercept = 2007),
             linetype = "dashed",
             color = "red")

```
```{r}

babynames %>%
  filter(name %in% c("Chloe", "Khloe")) %>%
  filter(year>=1990, sex == "F") %>% 
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = name))


babynames %>%
  filter(name %in% c("Courtney", "Kourtney")) %>%
  filter(year>=1990, sex=="F") %>% 
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = name))

```
```{r}
kidsnames <- c("Mason", "Penelope", "Reign", "North", "Saint", "Dream")

kardashian_kids <- data.frame( 
  name = kidsnames, year = c(2009, 2012, 2014, 2013, 2015, 2016)
  
  )

babynames %>%
  filter(name %in% kidsnames) %>%
  filter(year>=2000) %>% 
  ggplot() +
  geom_point(mapping = aes( x=year, y = n, color = sex)) + 
  facet_wrap(~name, scales = "free_y") +  
  
    geom_vline(aes(xintercept = year),
             linetype = "dashed",
             color = "red",
             data = kardashian_kids)
```


```{r}
babynames %>% 
  filter(year==2011, sex == "M") %>% 
  arrange(desc(n))

babynames %>% 
  filter(year==2009, sex == "M") %>% 
  arrange(desc(n))
babynames %>% 
  filter(year==2010, sex == "M") %>% 
  arrange(desc(n))

```



